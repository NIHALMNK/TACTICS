<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tactics</title>
    <link rel="icon" type="image/x-icon" href="/images/produts-tactics/LOGO/3.png">

    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/user/signup.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"></script>
    <style>
        
.swal-modal {
    border-radius: 10px; 
    background-color: #f0f0f0;
    font-family: Arial, sans-serif;
}

.swal-title {
    color: #333; 
    font-size: 20px;
    font-weight: bold;
}

.swal-text {
    color: #666; 
    font-size: 16px;
}

.swal-button {
    background-color: #4CAF50; 
    color: white;
    border: none;
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
    border-radius: 5px;
    transition: background-color 0.3s;
}

.swal-button:hover {
    background-color: #45a049;  
} 
    </style>

</head>
<body>
    <!-------------------------------------------------------------------------------------------------------------------------------------------------------------------------->
    <%- include('./layout/NAV.ejs') %>
    <!----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------->
    
    <div class="container-fluid">
        <div class="login-container">
            <div class="row h-100">
                <div class="col-lg-6 login-section">
                    <div class="login-content fade-in">
                        <a href="#" class="back-button">
                            <i class="fas fa-arrow-left me-2"></i>
                            Back
                        </a>
                        <h1 class="mb-2 fw-bold">Get Started Now</h1>
                        <p class="text-muted mb-4">Enter your details to create your account</p>
                        
                        <div class="success-message">
                            <i class="fas fa-check-circle me-2"></i>
                            Account created successfully! Redirecting...
                        </div>

                        <form id="signupForm" >
                            <div class="form-floating">
    <!--------------------------------------------------------------------------------------------------------------------->
    <!--------------------------------------------------------------------------------------------------------------------->
                                <input type="text" class="form-control" id="name" placeholder="Full Name" name="name" required>
                                <label for="nameInput">Full Name</label>
                                <div class="invalid-feedback">
                                    Please enter your full name
                                </div>
                            </div>

                            <div class="form-floating">
                                <input type="email" class="form-control" id="email" placeholder="name@example.com" name="email" required>
                                <label for="emailInput">Email address</label>
                                <div class="invalid-feedback">
                                    Please enter a valid email address
                                </div>
                            </div>

                            <div class="form-floating">
                                <input 
                                    type="tel" 
                                    class="form-control" 
                                    id="phno" 
                                    placeholder="Phone Number" 
                                    name="phone" 
                                    required 
                                    pattern="^\+?[0-9]{10,15}$">
                                <label for="phoneInput">Phone Number</label>
                                <div class="invalid-feedback">
                                    Please enter a valid phone number (10-15 digits, optional '+' prefix).
                                </div>
                            </div>
                            
                            
                            <div class="form-floating password-field">
                                <input type="password" class="form-control" id="password" placeholder="Password" name="password" required minlength="8">
                                <label for="passwordInput">Password</label>
                                <button type="button" class="password-toggle" aria-label="Toggle password visibility">
                                    <i class="fas fa-eye-slash"></i>
                                </button>
                                <div class="invalid-feedback">
                                    Password must be at least 8 characters long
                                </div>
                            </div>

                            <div class="form-floating password-field">
                                <input type="password" class="form-control" id="confirmPassword" placeholder="Password" name="password" required minlength="8">
                                <label for="passwordInput">conformPassword</label>
                            </div>

                            <div class="form-check mb-4">
                                <input class="form-check-input" type="checkbox" id="terms" required>
                                <label class="form-check-label" for="terms">
                                    I agree to the terms & policy
                                </label>
                                <div class="invalid-feedback">
                                    You must agree to the terms and policy
                                </div>
                            </div>
                            <button type="submit" class="btn-signup " id="submit" placeholder="Submit">Register</button>
                        </form>
                            
                            
                            <div class="divider">or</div>
                            
                            <div class="row g-3 mb-4 justify-content-center">
                                
                                
                                <div class="col-md-4 col-sm-6">
                                    <form action="/auth/google">
                                        <button 
                                            type="submit" 
                                            class="social-button w-100 d-flex align-items-center justify-content-center gap-2" 
                                            aria-label="Sign in with Google">
                                            <img src="/images/logos/google.png" alt="Google Logo">
                                            <span>Google</span>
                                        </button>
                                    </form>
                                </div>
                            </div>
                            
                            
                            <p class="text-center signin-text">
                                Have an account? <a href="/login">Sign in</a>
                            </p>

                    </div>
                </div>
                <div class="col-lg-6 image-section p-0">
                    <img src="/images/logSide/about-02.jpg" alt="Signup page decorative image">
                </div>
            </div>
        </div>
    </div>
    <!----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------->
    <%- include('./layout/FOOTER.ejs') %>
    
    
    <!----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------->
    

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
     <script>
           document.getElementById('submit').addEventListener('click', formValidate)

           document.querySelectorAll(".password-toggle").forEach((toggleButton) => {
    toggleButton.addEventListener("click", () => {
        const input = document.getElementById("password");
        const conforminput = document.getElementById("conforminput");

        const icon = toggleButton.querySelector("i");

        if (input.type === "password") {
            input.type = "text";
            
            icon.classList.replace("fa-eye-slash", "fa-eye");

        } else {
            input.type = "password";
            
            icon.classList.replace("fa-eye", "fa-eye-slash");

        }
    });
});

async function formValidate(e) {
    e.preventDefault();
    var name = document.getElementById('name').value.trim();
    var email = document.getElementById('email').value.trim();
    var phno = document.getElementById('phno').value.trim();
    var password = document.getElementById('password').value.trim();
    var confirmPassword = document.getElementById('confirmPassword').value.trim();
    var termsChecked = document.getElementById('terms').checked;

    const userExists = await checkUser(name,email,phno,password);
    if(name==""||email==""||phno==""||confirmPassword==""||password==""){
        Swal.fire({
            icon: 'error',
            title: 'Error!',
            text: 'fields are empty'
        });
    }
  if(userExists) {
        Swal.fire({
            icon:'success',
            title: 'Success!',
            text: 'User created successfully! Redirecting...'
        });
        window.location.href = "/register/otp"
        return true;
    }

}
async function checkUser(name,email,phno,password) {
    try {

        const response = await fetch('/register/check-user', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                name: name,
                email: email,
                phno: phno,
                password: password
            } )
        });

        const data = await response.json();
        if(!data.success) {
            return data.success; 
        }else{
            return data.success; 
        }
        console.log('data --> : ' + data);
    } catch (error) {
        console.error('Error checking user:', error);
        return false; 
    }
}
     </script>

    </body>
    </html>
    
    

    